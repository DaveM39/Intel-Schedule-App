#:import DayTab app.views.tabs.DayTab
#:import CATEGORY_COLORS app.models.CATEGORY_COLORS
#:import ActivityDialogContent app.views.dialogs.ActivityDialogContent
#:import Legend app.views.legend.Legend

<MainScreen@MDBoxLayout>:
    id: main_screen
    orientation: "vertical"
    MDToolbar:
        id: toolbar
        title: app.title_text
        right_action_items: [["account", lambda x: app.set_name()],
                             ["content-save", lambda x: app.save_schedule()],
                             ["folder", lambda x: app.load_schedule()],
                             ["theme-light-dark", lambda x: app.toggle_theme()]]
    MDBoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: dp(48)
        MDTextField:
            id: start_date
            hint_text: "Off-cycle start"
            on_focus: if self.focus: app.open_date_picker()
        MDRaisedButton:
            text: "Calc Cycle"
            on_release: app.calculate_cycle()
    MDTextField:
        id: results
        multiline: True
        readonly: True
        size_hint_y: None
        height: dp(120)
    Legend:
        id: legend
        size_hint_y: None
        height: dp(48)
    MDTabs:
        id: tabs
    MDLabel:
        text: "Personal Notes:"
        size_hint_y: None
        height: dp(30)
    MDTextField:
        id: notes_field
        multiline: True
        on_text: app.on_notes_changed(self.text)

<DayTab>:
    orientation: "vertical"
    MDLabel:
        text: root.title
        bold: True
        halign: "left"
        size_hint_y: None
        height: dp(30)
    ScheduleRecycleView:
        id: rv
        viewclass: "ActivityRow"
        data: []
        RecycleBoxLayout:
            default_size: None, dp(48)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'

<ActivityRow@TwoLineListItem>:
    time: ""
    description: ""
    category: ""
    day_key: ""
    index: 0
    text: root.time
    secondary_text: root.description
    on_release: app.edit_activity(root.day_key, root.index)
    canvas.before:
        Color:
            rgba: app.get_category_rgba(root.category)
        Rectangle:
            pos: self.pos
            size: self.size

<ActivityDialogContent>:
    orientation: "vertical"
    spacing: dp(10)
    size_hint_y: None
    height: dp(180)
    MDTextField:
        id: time_field
        hint_text: "Time"
        text: root.time
    MDTextField:
        id: desc_field
        hint_text: "Activity"
        text: root.description
    MDTextField:
        id: cat_field
        hint_text: "Category"
        text: root.category
